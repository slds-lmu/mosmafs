<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to MOSMaFS • mosmafs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to MOSMaFS">
<meta property="og:description" content="mosmafs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mosmafs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Github Version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/demo.html">Introduction to MOSMaFS</a>
    </li>
    <li>
      <a href="../articles/multifidelity.html">Multi-Fidelity MOSMaFS</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/compstat-lmu/mosmafs/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to MOSMaFS</h1>
                        <h4 class="author">Martin Binder</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/compstat-lmu/mosmafs/blob/master/vignettes/demo.Rmd"><code>vignettes/demo.Rmd</code></a></small>
      <div class="hidden name"><code>demo.Rmd</code></div>

    </div>

    
    
<div id="using-mosmafs" class="section level2">
<h2 class="hasAnchor">
<a href="#using-mosmafs" class="anchor"></a>Using MOSMaFS</h2>
<p><code>mosmafs</code> offers a variety of tools that make it possible to use the <a href="https://github.com/jakobbossek/ecr2"><code>ecr</code></a> package for multi-objective optimization of mixed parameter spaces. Mixed here means spaces that both include categorical and numeric hyperparameters. The following (a little contrived) example shows how to use these tools.</p>
<p><code>mosmafs</code> crucially depends on the <code>ecr</code> package (currently the github-version!), so make sure you have it installed and loaded. Other packages for this example should also be loaded.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"jakobbossek/ecr2"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ecr"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"magrittr"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ParamHelpers"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mlr"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mlrCPO"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mosmafs"</span>)</pre></body></html></div>
</div>
<div id="demo-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#demo-setup" class="anchor"></a>Demo Setup</h2>
<div id="example-operators" class="section level3">
<h3 class="hasAnchor">
<a href="#example-operators" class="anchor"></a>Example Operators</h3>
<p>To visualise what is going on, we will introduce a few deterministic operators that perform operations that can be easily understood and followed. These will all be mutation operators; recombination operators work the same but are more annoying to visualize.</p>
<p>The <strong>flipflop</strong> operator negates all bits of a binary individuum:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">mutFlipflop</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ecr/man/makeMutator.html">makeMutator</a></span>(
  <span class="kw">mutator</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">ind</span>, <span class="no">...</span>) {
    <span class="fl">1</span> - <span class="no">ind</span>
  }, <span class="kw">supported</span> <span class="kw">=</span> <span class="st">"binary"</span>)

<span class="fu">mutFlipflop</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>))
<span class="co">#&gt; [1] 0 1 0</span></pre></body></html></div>
<p>The <strong>cycle</strong> operator cycles through the values of a discrete (<code>character</code>) individuum:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">mutCycle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ecr/man/makeMutator.html">makeMutator</a></span>(
  <span class="kw">mutator</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">ind</span>, <span class="no">values</span>) {
    <span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span>(<span class="no">match</span>, <span class="no">ind</span>, <span class="no">values</span>)
    <span class="no">index</span> <span class="kw">&lt;-</span> <span class="no">index</span> <span class="kw">%%</span> <span class="fu">viapply</span>(<span class="no">values</span>, <span class="no">length</span>) + <span class="fl">1</span>
    <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span>(<span class="no">`[[`</span>, <span class="no">values</span>, <span class="no">index</span>)
  }, <span class="kw">supported</span> <span class="kw">=</span> <span class="st">"custom"</span>)

<span class="fu">mutCycle</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">letters</span>))
<span class="co">#&gt; [1] "b" "y" "a"</span></pre></body></html></div>
<p>The <strong>plus</strong> operator adds a parametervalue (default one) to the value of an individuum.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">mutPlus</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ecr/man/makeMutator.html">makeMutator</a></span>(
  <span class="kw">mutator</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">ind</span>, <span class="no">summand</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="no">...</span>) {
    <span class="no">ind</span> + <span class="no">summand</span>
  }, <span class="kw">supported</span> <span class="kw">=</span> <span class="st">"custom"</span>)

<span class="fu">mutPlus</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>))
<span class="co">#&gt; [1] 2 3 4</span></pre></body></html></div>
<p>The <strong>reverse</strong> operator reverses the order of an individuum:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">mutReverse</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ecr/man/makeMutator.html">makeMutator</a></span>(
  <span class="kw">mutator</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">ind</span>, <span class="no">...</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="no">ind</span>)
  }, <span class="kw">supported</span> <span class="kw">=</span> <span class="st">"custom"</span>)

<span class="fu">mutReverse</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>))
<span class="co">#&gt; [1] 3 2 1</span></pre></body></html></div>
</div>
<div id="example-datasets" class="section level3">
<h3 class="hasAnchor">
<a href="#example-datasets" class="anchor"></a>Example Datasets</h3>
<p>The <code>mosmafs</code> package comes with a few functions that generate synthetic datasets that can be used for feature selection. The following creates three columns of randomly sampled points in the <code>[-1, 1]^3</code> cube and a target column indicating whether each point is a distance greater than 1 away from the origin. Then ten more copies of that task are added, but with permuted rows—effectively giving 30 noise columns (the piping operator <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code> from the <code>magrittr</code> package is used for parsimonity).</p>
<p>To show the holdout prediction functionality, we will retain a part of the task as a “holdout” set.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">task.whole</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/create.hypersphere.data.html">create.hypersphere.data</a></span>(<span class="fl">3</span>, <span class="fl">2000</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/create.regr.task.html">create.classif.task</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"sphere"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/task.add.permuted.cols.html">task.add.permuted.cols</a></span>(<span class="fl">10</span>)
<span class="no">rows.whole</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">2000</span>)
<span class="no">task</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mlr.mlr-org.com/reference/subsetTask.html">subsetTask</a></span>(<span class="no">task.whole</span>, <span class="no">rows.whole</span>[<span class="fl">1</span>:<span class="fl">500</span>])
<span class="no">task.hout</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mlr.mlr-org.com/reference/subsetTask.html">subsetTask</a></span>(<span class="no">task.whole</span>, <span class="no">rows.whole</span>[<span class="fl">501</span>:<span class="fl">2000</span>])</pre></body></html></div>
</div>
</div>
<div id="mixed-operators" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-operators" class="anchor"></a>Mixed Operators</h2>
<p>The heart of this package is the <code><a href="../reference/combine.operators.html">combine.operators()</a></code> function that can be used to apply different operators to different parts of the search space; in particular, to different types of search space dimensions. It works by accepting a <code>ParamSet</code> (from the <a href="https://github.com/berndbischl/ParamHelpers"><code>ParamHelpers</code></a> package) that defines the search-space, and operators that define the operators to use on individual parameters.</p>
<div id="operators-for-each-parameter" class="section level3">
<h3 class="hasAnchor">
<a href="#operators-for-each-parameter" class="anchor"></a>Operators for each Parameter</h3>
<p>We may have a <code>ParamSet</code> with a logical parameter <code>bin1</code>, a discrete (but binary) parameter <code>bin2</code>, a discrete vector parameter <code>disc1</code>, and a numeric parameter <code>num1</code>. We define this <code>ParamSet</code> using the <code><a href="https://rdrr.io/pkg/mlrCPO/man/pSS.html">pSS()</a></code> function from the excellent <a href="https://github.com/mlr-org/mlrCPO"><code>mlrCPO</code></a> package.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">ps</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mlrCPO/man/pSS.html">pSS</a></span>(
  <span class="no">bin1</span>: <span class="no">logical</span>,
  <span class="no">bin2</span>: <span class="no">discrete</span>[<span class="no">no</span>, <span class="no">yes</span>],
  <span class="no">disc1</span>: <span class="no">discrete</span>[<span class="no">letters</span>]^<span class="fl">3</span>,
  <span class="no">num1</span>: <span class="no">numeric</span>[<span class="fl">0</span>, <span class="fl">10</span>])</pre></body></html></div>
<p>We can now define an operator that uses the <code>mutFlipflop</code> operator on both <code>bin1</code> and <code>bin2</code>, the <code>mutCycle</code> operator on <code>disc1</code>, and the <code>mutPlus</code> operator on <code>num1</code>:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps</span>,
  <span class="kw">bin1</span> <span class="kw">=</span> <span class="no">mutFlipflop</span>,
  <span class="kw">bin2</span> <span class="kw">=</span> <span class="no">mutFlipflop</span>,
  <span class="kw">disc1</span> <span class="kw">=</span> <span class="no">mutCycle</span>,
  <span class="kw">num1</span> <span class="kw">=</span> <span class="no">mutPlus</span>)</pre></body></html></div>
<p>Here we are treating <code>bin2</code> as a binary parameter, so we have to leave the <code>.binary.discrete.as.logical</code> parameter of <code>combine.operators</code> as <code>TRUE</code>. If we wanted to use the <code>mutCycle</code> operation on the <code>bin2</code> operator, we would have to tell <code><a href="../reference/combine.operators.html">combine.operators()</a></code> to treat it as a discrete parameter:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">combo2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps</span>,
  <span class="kw">bin1</span> <span class="kw">=</span> <span class="no">mutFlipflop</span>,
  <span class="kw">bin2</span> <span class="kw">=</span> <span class="no">mutCycle</span>,
  <span class="kw">disc1</span> <span class="kw">=</span> <span class="no">mutCycle</span>,
  <span class="kw">num1</span> <span class="kw">=</span> <span class="no">mutPlus</span>,
  <span class="kw">.binary.discrete.as.logical</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>Both these operators do essentially the same: They flip / cycle the binary and discrete parameters, and increase the numeric parameter by one.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu">combo</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bin1</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bin2</span> <span class="kw">=</span> <span class="st">"no"</span>, <span class="kw">disc1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">num1</span> <span class="kw">=</span> <span class="fl">3</span>))
<span class="co">#&gt; list(bin1 = FALSE, bin2 = "yes", disc1 = c("b", "y", "a"), num1 = 4)</span>

<span class="fu">combo2</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bin1</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bin2</span> <span class="kw">=</span> <span class="st">"no"</span>, <span class="kw">disc1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">num1</span> <span class="kw">=</span> <span class="fl">3</span>))
<span class="co">#&gt; list(bin1 = FALSE, bin2 = "yes", disc1 = c("b", "y", "a"), num1 = 4)</span></pre></body></html></div>
</div>
<div id="operators-for-parameter-types-and-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#operators-for-parameter-types-and-groups" class="anchor"></a>Operators for Parameter Types and Groups</h3>
<p>Especially with larger parameter spaces it may be more desirable to define operations not for each parameter individually, but for groups of parameters. Groups can be declared by setting the special <code>.params.&lt;GROUPNAME&gt;</code> value to a <code>character</code> vector of parameter values to combine into a group. The special groups <code>numeric</code>, <code>logical</code>, <code>integer</code>, and <code>discrete</code> are pre-defined and group all parameters of a type that are not otherwise given an operator.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">combo.group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps</span>,
  <span class="kw">.params.group1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bin1"</span>, <span class="st">"bin2"</span>),
  <span class="kw">group1</span> <span class="kw">=</span> <span class="no">mutFlipflop</span>,
  <span class="kw">discrete</span> <span class="kw">=</span> <span class="no">mutCycle</span>,
  <span class="kw">num1</span> <span class="kw">=</span> <span class="no">mutPlus</span>)</pre></body></html></div>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu">combo.group</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bin1</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bin2</span> <span class="kw">=</span> <span class="st">"no"</span>, <span class="kw">disc1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">num1</span> <span class="kw">=</span> <span class="fl">3</span>))
<span class="co">#&gt; list(bin1 = FALSE, bin2 = "yes", disc1 = c("b", "y", "a"), num1 = 4)</span></pre></body></html></div>
<p>When parameters are put in a group, they are passed to the underlying operators as a vector. This may make a difference if operations depend on the global state of a vector and don’t just operate component-wise. This can be shown with the <code>mutReverse</code> operator, when given for a group vs. when given for parameters individually:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">combo.rev.indiv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps</span>,
  <span class="kw">bin1</span> <span class="kw">=</span> <span class="no">mutReverse</span>,
  <span class="kw">bin2</span> <span class="kw">=</span> <span class="no">mutReverse</span>,
  <span class="kw">discrete</span> <span class="kw">=</span> <span class="no">mutCycle</span>,
  <span class="kw">num1</span> <span class="kw">=</span> <span class="no">mutPlus</span>)

<span class="no">combo.rev.group</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps</span>,
  <span class="kw">.params.group1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bin1"</span>, <span class="st">"bin2"</span>),
  <span class="kw">group1</span> <span class="kw">=</span> <span class="no">mutReverse</span>,
  <span class="kw">discrete</span> <span class="kw">=</span> <span class="no">mutCycle</span>,
  <span class="kw">num1</span> <span class="kw">=</span> <span class="no">mutPlus</span>)</pre></body></html></div>
<p>When applied to <code>bin1</code> and <code>bin2</code> individually, the <code>mutReverse</code> operator does not change the values:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu">combo.rev.indiv</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bin1</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bin2</span> <span class="kw">=</span> <span class="st">"no"</span>, <span class="kw">disc1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">num1</span> <span class="kw">=</span> <span class="fl">3</span>))
<span class="co">#&gt; list(bin1 = TRUE, bin2 = "no", disc1 = c("b", "y", "a"), num1 = 4)</span></pre></body></html></div>
<p>However, when they are in a group, the values of <code>bin1</code> and <code>bin2</code> are combined as a vector and given to <code>mutReverse</code>. The <code>TRUE</code> value is given as value <code>1</code>, the <code>"no"</code> value is given as value <code>0</code>. They are swapped, and the return list contains <code>bin1 = FALSE</code> and <code>bin2 = "yes"</code>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu">combo.rev.group</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bin1</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bin2</span> <span class="kw">=</span> <span class="st">"no"</span>, <span class="kw">disc1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">num1</span> <span class="kw">=</span> <span class="fl">3</span>))
<span class="co">#&gt; list(bin1 = FALSE, bin2 = "yes", disc1 = c("b", "y", "a"), num1 = 4)</span></pre></body></html></div>
<p>Because of this, it is <strong>usually a bad idea</strong> to combine parameters of different types into a single group. Discrete parameters (non-binary discrete parameters if <code>.binary.discrete.as.logical</code> is <code>TRUE</code>) can not be grouped together with other types of parameters.</p>
</div>
<div id="strategy-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#strategy-parameters" class="anchor"></a>Strategy Parameters</h3>
<p>A further extension offered by the <code><a href="../reference/combine.operators.html">combine.operators()</a></code> function is the ability to use “strategy parameters”. They make it possible to have the effect of an operator be dependent on the individuals involved. To do this, a <code>.strategy.&lt;PARAMETER/GROUPNAME&gt;</code> value must be given, which should be a function that gets the individuum as input, and returns a named list of function parameters as output. This named list is added to the configuration of the operator associated with <code>&lt;PARAMETER&gt;</code> or <code>&lt;GROUPNAME&gt;</code>.</p>
<p>One could, for example, make the <code>summand</code> parameter of the <code>mutPlus</code> operation dependent on the <code>bin2</code> value: If it is <code>"yes"</code>, it adds a value, if it is <code>"no"</code> it subtracts a value.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">combo.strategy</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps</span>,
  <span class="kw">logical</span> <span class="kw">=</span> <span class="no">mutFlipflop</span>,
  <span class="kw">discrete</span> <span class="kw">=</span> <span class="no">mutCycle</span>,
  <span class="kw">numeric</span> <span class="kw">=</span> <span class="no">mutPlus</span>,
  <span class="kw">.strategy.numeric</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">ind</span>) {
    <span class="kw">if</span> (<span class="no">ind</span>$<span class="no">bin2</span> <span class="kw">==</span> <span class="st">"yes"</span>) {
      <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">summand</span> <span class="kw">=</span> <span class="fl">1</span>))
    } <span class="kw">else</span> {
      <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">summand</span> <span class="kw">=</span> -<span class="fl">1</span>))
    }
  })</pre></body></html></div>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu">combo.strategy</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bin1</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bin2</span> <span class="kw">=</span> <span class="st">"yes"</span>, <span class="kw">disc1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">num1</span> <span class="kw">=</span> <span class="fl">3</span>))
<span class="co">#&gt; list(bin1 = FALSE, bin2 = "no", disc1 = c("b", "y", "a"), num1 = 4)</span>

<span class="fu">combo.strategy</span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bin1</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">bin2</span> <span class="kw">=</span> <span class="st">"no"</span>, <span class="kw">disc1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"x"</span>, <span class="st">"z"</span>), <span class="kw">num1</span> <span class="kw">=</span> <span class="fl">3</span>))
<span class="co">#&gt; list(bin1 = FALSE, bin2 = "yes", disc1 = c("b", "y", "a"), num1 = 2)</span></pre></body></html></div>
<p>Note how the value of <code>ind$bin2</code> from <em>before</em> the <code>mutFlipflop</code> operation is used: The value that counts is always the input value given to the operator. It is therefore possible to use the values as strategy parameters for their own mutation.</p>
</div>
<div id="recombination-operators" class="section level3">
<h3 class="hasAnchor">
<a href="#recombination-operators" class="anchor"></a>Recombination Operators</h3>
<p>Recombination operators can be combined in the same way that mutation operators can be. The input to a recombination operator is usually a list with two individuals, so the input to the strategy parameter function is also a list with two vectors. This function has to decide whether to construct a strategy depending to one of these individuals, or whether to combine their values, for example averaging them.</p>
</div>
<div id="mixed-operator-individuals" class="section level3">
<h3 class="hasAnchor">
<a href="#mixed-operator-individuals" class="anchor"></a>Mixed Operator Individuals</h3>
<p>When using the <code>ecr</code> package with its vanilla operators, individuals are usually vectors of numbers, for example 0-1-vectors for binary individuals, or <code>numeric</code> values for continuous valued individuals. When using mixed operators, the individuals have to be <em>named lists</em>, with names and types corresponding to the <code>ParamSet</code> given to <code><a href="../reference/combine.operators.html">combine.operators()</a></code>. The supported <code>Param</code> types, and the expected entries in the individual lists, are the following:</p>
<table class="table">
<thead><tr class="header">
<th>Parameter Construction (<code>ParamHelpers</code>)</th>
<th>
<code><a href="https://rdrr.io/pkg/mlrCPO/man/pSS.html">pSS()</a></code> sugar</th>
<th>Type Expected</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<code>makeNumericParam</code>/<code>makeNumericVectorParam</code>
</td>
<td><code>numeric[, ]</code></td>
<td><code>numeric</code></td>
</tr>
<tr class="even">
<td>
<code>makeIntegerParam</code>/<code>makeIntegerVectorParam</code>
</td>
<td><code>integer[, ]</code></td>
<td>(integer) <code>numeric</code>
</td>
</tr>
<tr class="odd">
<td>
<code>makeLogicalParam</code>/<code>makeLogicalVectorParam</code>
</td>
<td><code>logical</code></td>
<td><code>logical</code></td>
</tr>
<tr class="even">
<td>
<code>makeDiscreteParam</code>/<code>makeDiscreteVectorParam</code>
</td>
<td><code>discrete[]</code></td>
<td><code>character</code></td>
</tr>
</tbody>
</table>
<p>The only possible surprise here is that individuals must have “<code>character</code>” entries for discrete parameters<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. That means, no <code>factor</code> entries, and no lists of characters for <code><a href="https://paramhelpers.mlr-org.com/reference/Param.html">makeDiscreteVectorParam()</a></code> types.</p>
<p>One can use the <code><a href="https://paramhelpers.mlr-org.com/reference/sampleValue.html">sampleValue()</a></code> function from the <code>ParamHelpers</code> package to generate valid, randomly sampled individuals to use with combined operators. The <code>discrete.names</code> option must be set to <code>TRUE</code> for that:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r">
<span class="no">value</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/sampleValue.html">sampleValue</a></span>(<span class="no">ps</span>, <span class="kw">discrete.names</span>  <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">value</span>)
<span class="co">#&gt; list(bin1 = TRUE, bin2 = "no", disc1 = c("y", "g", "y"), num1 = 8.111)</span>

<span class="fu">combo</span>(<span class="no">value</span>)
<span class="co">#&gt; list(bin1 = FALSE, bin2 = "yes", disc1 = c("z", "h", "z"), num1 = 9.111)</span></pre></body></html></div>
</div>
</div>
<div id="ga-application" class="section level2">
<h2 class="hasAnchor">
<a href="#ga-application" class="anchor"></a>GA Application</h2>
<div id="first-steps" class="section level3">
<h3 class="hasAnchor">
<a href="#first-steps" class="anchor"></a>First Steps</h3>
<p>Having a way to use mutation and recombination operators for mixed type individuals is already a big step towards using the <code>ecr</code> package for simultaneous model and feature selection (“SMaFS”). It is still necessary to define the actual objective, for which we need a <code>Learner</code>, a <code>Task</code>, as well as a hyperparameter space to optimize over.</p>
<p>In this example, we choose to optimize the <code>"classif.rpart"</code> learner from the <code>rpart</code> package, on the <code>task</code> defined <a href="#example-datasets">above</a>.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">lrn</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://mlr.mlr-org.com/reference/makeLearner.html">makeLearner</a></span>(<span class="st">"classif.rpart"</span>, <span class="kw">maxsurrogate</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p>The parameter set we optimize over is the following</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">ps.simple</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mlrCPO/man/pSS.html">pSS</a></span>(
  <span class="no">maxdepth</span>: <span class="no">integer</span>[<span class="fl">1</span>, <span class="fl">30</span>],
  <span class="no">minsplit</span>: <span class="no">integer</span>[<span class="fl">2</span>, <span class="fl">30</span>],
  <span class="no">cp</span>: <span class="no">numeric</span>[<span class="fl">0.001</span>, <span class="fl">0.999</span>])</pre></body></html></div>
<p>Furthermore, a resampling strategy must be chosen. It can be either a <code><a href="https://mlr.mlr-org.com/reference/makeResampleDesc.html">mlr::ResampleDesc</a></code> object, <code>mlr::ResampleInst</code> object or any function which maps fidelity to the resampling to use. We use the resampling strategy <code><a href="https://mlr.mlr-org.com/reference/makeResampleDesc.html">mlr::cv5</a></code>.</p>
<p>Now we have all the information needed to define an objective function we try to optimize. If we are doing feature selection, the <code><a href="../reference/makeObjective.html">makeObjective()</a></code> function does this for us; otherwise we would need to define a “<code>smoof</code>” function using <code><a href="https://rdrr.io/pkg/smoof/man/makeSingleObjectiveFunction.html">smoof::makeSingleObjectiveFunction()</a></code> or <code><a href="https://rdrr.io/pkg/smoof/man/makeMultiObjectiveFunction.html">smoof::makeMultiObjectiveFunction()</a></code>.</p>
<p>The <code><a href="../reference/makeObjective.html">makeObjective()</a></code> function allows us to supply a holdout dataset on which each model will be evaluated. If a holdout is given, then the resampling is performed as given to the <code>resampling</code> parameter, and, <em>additionally</em>, the given <code>Learner</code> is trained on the whole training data and predicted on the holdout set.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">fitness.fun.simple</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/makeObjective.html">makeObjective</a></span>(<span class="no">lrn</span>, <span class="no">task</span>, <span class="no">ps.simple</span>, <span class="no">cv5</span>,
  <span class="kw">holdout.data</span> <span class="kw">=</span> <span class="no">task.hout</span>)</pre></body></html></div>
<p>Notably the parameter <code>selector.selection</code> was added within <code><a href="../reference/makeObjective.html">makeObjective()</a></code> to the parameter set, which controls what features are selected. The new parameter set needs to be used for the definition of the mutators and recombinators.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">ps.objective</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/getParamSet.html">getParamSet</a></span>(<span class="no">fitness.fun.simple</span>)</pre></body></html></div>
<p>We are using some standard mutation and recombination operators for the parameters: Gaussian and rounded-gaussian mutation for numeric parameters, hamming weight preserving bitflip for <code>selector.selection</code>, and generally uniform crossover mutation. We use the <code><a href="https://rdrr.io/pkg/ecr/man/setup.html">ecr::setup</a></code> method to set hyperparameters of some mutation operators.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">mutator.simple</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps.objective</span>,
  <span class="kw">numeric</span> <span class="kw">=</span> <span class="kw pkg">ecr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecr/man/setup.html">setup</a></span>(<span class="no">mutGauss</span>, <span class="kw">sdev</span> <span class="kw">=</span> <span class="fl">0.1</span>),
  <span class="kw">integer</span> <span class="kw">=</span> <span class="kw pkg">ecr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecr/man/setup.html">setup</a></span>(<span class="no">mutGaussInt</span>, <span class="kw">sdev</span> <span class="kw">=</span> <span class="fl">3</span>),
  <span class="kw">selector.selection</span> <span class="kw">=</span> <span class="no">mutBitflipCHW</span>)

<span class="no">crossover.simple</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps.objective</span>,
  <span class="kw">numeric</span> <span class="kw">=</span> <span class="no">recPCrossover</span>,
  <span class="kw">integer</span> <span class="kw">=</span> <span class="no">recPCrossover</span>,
  <span class="kw">selector.selection</span> <span class="kw">=</span> <span class="no">recPCrossover</span>)</pre></body></html></div>
<p>The initial population to sample over can be generated using the <code>ParamHelpers</code> function <code><a href="https://paramhelpers.mlr-org.com/reference/sampleValues.html">sampleValues()</a></code>. Note that by generating an initial population of a certain size (32 here), we implicitly determine the ECR hyperparameter <code>mu</code> of individuals in a generation.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">initials.simple</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/sampleValues.html">sampleValues</a></span>(<span class="no">ps.objective</span> , <span class="fl">32</span>, <span class="kw">discrete.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>This is all that is necessary, and it can be used to call the <code><a href="https://rdrr.io/pkg/ecr/man/ecr.html">ecr()</a></code> function in the <code>ecr</code> package. The <code>mosmafs</code> package comes with a useful interface that sets some defaults: <code><a href="../reference/slickEcr.html">slickEcr()</a></code>. The run time, 10 generations, would probably be to short for serious applications, but should be enough for demonstration purposes.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">run.simple</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/slickEcr.html">slickEcr</a></span>(
  <span class="kw">fitness.fun</span> <span class="kw">=</span> <span class="no">fitness.fun.simple</span>,
  <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">16</span>,
  <span class="kw">population</span> <span class="kw">=</span> <span class="no">initials.simple</span>,
  <span class="kw">mutator</span> <span class="kw">=</span> <span class="no">mutator.simple</span>,
  <span class="kw">recombinator</span> <span class="kw">=</span> <span class="no">crossover.simple</span>,
  <span class="kw">generations</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p>There is a multitude of methods for analysing and plotting the result. The following plots the succession of pareto fronts for each generation:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">plot_fronts</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">run</span>) {
  <span class="no">fronts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fitnesses.html">fitnesses</a></span>(<span class="no">run</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="../reference/paretoEdges.html">paretoEdges</a></span>(<span class="no">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>)))
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">fronts</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">perf</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">propfeat</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span>(<span class="no">gen</span>))) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">fronts</span>[<span class="no">fronts</span>$<span class="no">point</span>, ], <span class="kw">shape</span> <span class="kw">=</span> <span class="st">"x"</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">5</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span>(<span class="fl">0</span>, <span class="fl">1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>()
}

<span class="fu">plot_fronts</span>(<span class="no">run.simple</span>)</pre></body></html></div>
<p><img src="demo_files/figure-html/unnamed-chunk-27-1.png" width="576"></p>
<p>It is possible to inspect the runtimes of individuals, they are stored as attribute <code>"runtime"</code>. The aggregated runtime for each generation can also be retrieved from the <code>log.newinds</code> logging object. The runtime of individuals within each generation can also be queried using <code>popAggregate</code>.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">populations</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getPopulations.html">getPopulations</a></span>(<span class="no">run.simple</span>$<span class="no">log</span>)
<span class="no">pop.gen1</span> <span class="kw">&lt;-</span> <span class="no">populations</span><span class="kw">[[</span><span class="fl">1</span>]]

<span class="no">individual.1</span> <span class="kw">&lt;-</span> <span class="no">pop.gen1</span>$<span class="no">population</span><span class="kw">[[</span><span class="fl">1</span>]]
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="no">individual.1</span>, <span class="st">"runtime"</span>)
<span class="co">#&gt;  elapsed </span>
<span class="co">#&gt; 0.226764</span>

<span class="no">individual.2</span> <span class="kw">&lt;-</span> <span class="no">pop.gen1</span>$<span class="no">population</span><span class="kw">[[</span><span class="fl">2</span>]]
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="no">individual.2</span>, <span class="st">"runtime"</span>)
<span class="co">#&gt;   elapsed </span>
<span class="co">#&gt; 0.2080401</span>

<span class="fu"><a href="../reference/getStatistics.html">getStatistics</a></span>(<span class="no">run.simple</span>$<span class="no">log.newinds</span>)
<span class="co">#&gt;    gen runtime.mean runtime.sum size population</span>
<span class="co">#&gt; 1    0    0.2342009    7.494428   32       init</span>
<span class="co">#&gt; 2    1    0.2428753    3.886004   16  offspring</span>
<span class="co">#&gt; 3    2    0.2245258    3.592412   16  offspring</span>
<span class="co">#&gt; 4    3    0.2196528    3.514444   16  offspring</span>
<span class="co">#&gt; 5    4    0.2620204    4.192326   16  offspring</span>
<span class="co">#&gt; 6    5    0.2373127    3.797003   16  offspring</span>
<span class="co">#&gt; 7    6    0.2400483    3.840772   16  offspring</span>
<span class="co">#&gt; 8    7    0.2393781    3.830050   16  offspring</span>
<span class="co">#&gt; 9    8    0.2106042    3.369667   16  offspring</span>
<span class="co">#&gt; 10   9    0.2444045    3.910472   16  offspring</span>
<span class="co">#&gt; 11  10    0.2334951    3.735921   16  offspring</span></pre></body></html></div>
<p>Run statistics about the progress of performance can also be retrieved using the <code><a href="../reference/collectResult.html">collectResult()</a></code> function. It creates a large <code>data.frame</code> with many entries. The following plots the progressive average resampling performance, both of the training data and the holdout data.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="../reference/collectResult.html">collectResult</a></span>(<span class="no">run.simple</span>), <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">evals</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">hout.perf.mean</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Holdout"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">eval.perf.mean</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Training"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">1</span>)</pre></body></html></div>
<p><img src="demo_files/figure-html/unnamed-chunk-29-1.png" width="576"></p>
<p>Notice the <code>"true.hout.domHV"</code> column which measures the dominated hypervolume on the holdout sample of those points that make up the paretofront on the training sample. It is a more realistic measure of generalization performance than the <code>"hout.domHV"</code> column, which measures dominated hypervolume on the holdout sample of all points in a generation.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="../reference/collectResult.html">collectResult</a></span>(<span class="no">run.simple</span>), <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">evals</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">true.hout.domHV</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Holdout"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">eval.domHV</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Training"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">1</span>)</pre></body></html></div>
<p><img src="demo_files/figure-html/unnamed-chunk-30-1.png" width="576"></p>
<p>The totality of information provided by <code><a href="../reference/collectResult.html">collectResult()</a></code> can be seen from its column names.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="fu"><a href="../reference/collectResult.html">collectResult</a></span>(<span class="no">run.simple</span>))
<span class="co">#&gt;  [1] "gen"                "runtime"            "evals"             </span>
<span class="co">#&gt;  [4] "eval.perf.min"      "eval.perf.mean"     "eval.perf.max"     </span>
<span class="co">#&gt;  [7] "eval.propfeat.min"  "eval.propfeat.mean" "eval.propfeat.max" </span>
<span class="co">#&gt; [10] "eval.domHV"         "hout.perf.min"      "hout.perf.mean"    </span>
<span class="co">#&gt; [13] "hout.perf.max"      "hout.propfeat.min"  "hout.propfeat.mean"</span>
<span class="co">#&gt; [16] "hout.propfeat.max"  "hout.domHV"         "true.hout.domHV"   </span>
<span class="co">#&gt; [19] "naive.hout.domHV"   "cor.perf"           "cor.propfeat"</span></pre></body></html></div>
</div>
<div id="filter-values-as-strategy-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-values-as-strategy-parameters" class="anchor"></a>Filter Values as Strategy Parameters</h3>
<p>It is possible to use “Feature Filter” values from <code>mlr</code> feature filters to heuristically guide mutation of the <code>selector.selection</code> bitvector. For this, the filter matrix can be generated using the <code><a href="../reference/makeFilterMat.html">makeFilterMat()</a></code> function, with a few features we choose (the github-version of <code>mlr</code> needs to be installed for this: <code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("mlr-org/mlr")</a></code>). For demonstration purposes, this contains the useless-in-this-case <code>"variance"</code> Filter that just measures each feature’s variance (to use the relatively good <code>"praznik_JMI"</code> filter it is necessary to install the github-version of <code>mlr</code>, e.g. by using <code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("mlr-org/mlr")</a></code>). The <code>"DUMMY"</code> filter does not exist in <code>mlr</code>, it instructs <code><a href="../reference/makeFilterMat.html">makeFilterMat()</a></code> to create a constant heuristic. It gives the strategy parameter another degree of freedom with which it can de-emphasize the heuristic in case it performs badly.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">filters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"praznik_JMI"</span>, <span class="st">"auc"</span>, <span class="st">"anova.test"</span>, <span class="st">"variance"</span>, <span class="st">"DUMMY"</span>)
<span class="no">fima</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/makeFilterMat.html">makeFilterMat</a></span>(<span class="no">task</span>, <span class="kw">filters</span> <span class="kw">=</span> <span class="no">filters</span>)</pre></body></html></div>
<p>We now create a <code>ParamSet</code> that includes one strategy parameter “<code>filterweights</code>”, which puts weights on the filter values and thereby controls how strong each one influences the mutation:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">ps.strat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mlrCPO/man/pSS.html">pSS</a></span>(
  <span class="no">maxdepth</span>: <span class="no">integer</span>[<span class="fl">1</span>, <span class="fl">30</span>],
  <span class="no">minsplit</span>: <span class="no">integer</span>[<span class="fl">2</span>, <span class="fl">30</span>],
  <span class="no">cp</span>: <span class="no">numeric</span>[<span class="fl">0.001</span>, <span class="fl">0.999</span>],
  <span class="no">filterweights</span>: <span class="no">numeric</span>[<span class="fl">0.001</span>, <span class="fl">0.999</span>]^<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">filters</span>))</pre></body></html></div>
<p>Before mutation and recombination can be defined, the parameter set must be substracted from <code><a href="../reference/makeObjective.html">makeObjective()</a></code></p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">fitness.fun.strat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/makeObjective.html">makeObjective</a></span>(<span class="no">lrn</span>, <span class="no">task</span>, <span class="no">ps.strat</span>, <span class="no">cv5</span>)
<span class="no">ps.strat.obj</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/getParamSet.html">getParamSet</a></span>(<span class="no">fitness.fun.strat</span>)</pre></body></html></div>
<p>The mutation operator must now include information on how to use the strategy parameter. Instead of writing out the function, we are using the helper <code><a href="../reference/makeFilterStrategy.html">makeFilterStrategy()</a></code> that is designed out for this usecase:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">mutator.strat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps.strat.obj</span>,
  <span class="kw">numeric</span> <span class="kw">=</span> <span class="kw pkg">ecr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecr/man/setup.html">setup</a></span>(<span class="no">mutGauss</span>, <span class="kw">sdev</span> <span class="kw">=</span> <span class="fl">0.1</span>),
  <span class="kw">integer</span> <span class="kw">=</span> <span class="kw pkg">ecr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecr/man/setup.html">setup</a></span>(<span class="no">mutGaussInt</span>, <span class="kw">sdev</span> <span class="kw">=</span> <span class="fl">3</span>),
  <span class="kw">selector.selection</span> <span class="kw">=</span> <span class="no">mutUniformMetaResetSHW</span>,
  <span class="kw">.strategy.selector.selection</span> <span class="kw">=</span> <span class="fu"><a href="../reference/makeFilterStrategy.html">makeFilterStrategy</a></span>(
    <span class="kw">reset.dists</span> <span class="kw">=</span> <span class="no">fima</span>, <span class="kw">weight.param.name</span> <span class="kw">=</span> <span class="st">"filterweights"</span>))</pre></body></html></div>
<p>We are going to use the same crossover operator as before, but we have to construct it with the new <code>ParamSet</code>:</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">crossover.strat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/combine.operators.html">combine.operators</a></span>(<span class="no">ps.strat.obj</span>,
  <span class="kw">numeric</span> <span class="kw">=</span> <span class="no">recPCrossover</span>,
  <span class="kw">integer</span> <span class="kw">=</span> <span class="no">recPCrossover</span>,
  <span class="kw">selector.selection</span> <span class="kw">=</span> <span class="no">recPCrossover</span>)</pre></body></html></div>
<p>We sample the initial population again using the <code>ParamHelpers</code> function <code><a href="https://paramhelpers.mlr-org.com/reference/sampleValues.html">sampleValues()</a></code> and resample the <code>$selector.selection</code> part using <code><a href="../reference/initSelector.html">initSelector()</a></code>. <code>initSelector</code> makes the number of 0s and 1s uniformly distributed, and applies the equilibrium-distribution of <code><a href="../reference/mutUniformResetSHW.html">mutUniformMetaResetSHW()</a></code>:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">initials.strat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://paramhelpers.mlr-org.com/reference/sampleValues.html">sampleValues</a></span>(<span class="no">ps.strat.obj</span>, <span class="fl">32</span>, <span class="kw">discrete.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/initSelector.html">initSelector</a></span>(
    <span class="kw">soften.op</span> <span class="kw">=</span> <span class="kw pkg">ecr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecr/man/setup.html">setup</a></span>(<span class="no">mutUniformMetaResetSHW</span>, <span class="kw">p</span> <span class="kw">=</span> <span class="fl">1</span>),
    <span class="kw">soften.op.strategy</span> <span class="kw">=</span> <span class="fu"><a href="../reference/makeFilterStrategy.html">makeFilterStrategy</a></span>(<span class="no">fima</span>, <span class="st">"filterweights"</span>))</pre></body></html></div>
<p>These are all preparations needed for a heuristic-backed NSGA2 for feature-selection:</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="no">run.strat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/slickEcr.html">slickEcr</a></span>(
  <span class="kw">fitness.fun</span> <span class="kw">=</span> <span class="no">fitness.fun.strat</span>,
  <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">16</span>,
  <span class="kw">population</span> <span class="kw">=</span> <span class="no">initials.strat</span>,
  <span class="kw">mutator</span> <span class="kw">=</span> <span class="no">mutator.strat</span>,
  <span class="kw">recombinator</span> <span class="kw">=</span> <span class="no">crossover.strat</span>,
  <span class="kw">generations</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p>The pareto-fronts of this run look as follows:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu">plot_fronts</span>(<span class="no">run.strat</span>)</pre></body></html></div>
<p><img src="demo_files/figure-html/unnamed-chunk-40-1.png" width="576"></p>
</div>
<div id="run-continuation" class="section level3">
<h3 class="hasAnchor">
<a href="#run-continuation" class="anchor"></a>Run Continuation</h3>
<p>The results returned by <code><a href="../reference/slickEcr.html">slickEcr()</a></code> contain all information to continue an optimization for more generations. To continue a run, use the <code><a href="../reference/slickEcr.html">continueEcr()</a></code> function. It is possible to change a few settings compared to the previous invocation of <code><a href="../reference/slickEcr.html">slickEcr()</a></code> (it is in fact possible to just create a result object without any generations using <code><a href="../reference/slickEcr.html">initEcr()</a></code>, and then call <code><a href="../reference/slickEcr.html">continueEcr()</a></code> at a later point on it).</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">run.strat.20</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/slickEcr.html">continueEcr</a></span>(<span class="no">run.strat</span>, <span class="fl">10</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">8</span>)</pre></body></html></div>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="../reference/getStatistics.html">getStatistics</a></span>(<span class="no">run.strat.20</span>$<span class="no">log.newinds</span>)
<span class="co">#&gt;    gen runtime.mean runtime.sum size population</span>
<span class="co">#&gt; 1    0    0.2328167    7.450133   32       init</span>
<span class="co">#&gt; 2    1    0.2206262    3.530019   16  offspring</span>
<span class="co">#&gt; 3    2    0.2484078    3.974524   16  offspring</span>
<span class="co">#&gt; 4    3    0.2648093    4.236949   16  offspring</span>
<span class="co">#&gt; 5    4    0.2245242    3.592388   16  offspring</span>
<span class="co">#&gt; 6    5    0.2571549    4.114479   16  offspring</span>
<span class="co">#&gt; 7    6    0.2388807    3.822092   16  offspring</span>
<span class="co">#&gt; 8    7    0.2404426    3.847082   16  offspring</span>
<span class="co">#&gt; 9    8    0.2266318    3.626109   16  offspring</span>
<span class="co">#&gt; 10   9    0.2416093    3.865749   16  offspring</span>
<span class="co">#&gt; 11  10    0.2507146    4.011434   16  offspring</span>
<span class="co">#&gt; 12  11    0.2239953    1.791962    8  offspring</span>
<span class="co">#&gt; 13  12    0.2366085    1.892868    8  offspring</span>
<span class="co">#&gt; 14  13    0.2385776    1.908621    8  offspring</span>
<span class="co">#&gt; 15  14    0.2427327    1.941862    8  offspring</span>
<span class="co">#&gt; 16  15    0.2425791    1.940633    8  offspring</span>
<span class="co">#&gt; 17  16    0.2456001    1.964801    8  offspring</span>
<span class="co">#&gt; 18  17    0.2540927    2.032742    8  offspring</span>
<span class="co">#&gt; 19  18    0.2544738    2.035790    8  offspring</span>
<span class="co">#&gt; 20  19    0.2290847    1.832678    8  offspring</span>
<span class="co">#&gt; 21  20    0.2320937    1.856750    8  offspring</span></pre></body></html></div>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu">plot_fronts</span>(<span class="no">run.strat.20</span>)</pre></body></html></div>
<p><img src="demo_files/figure-html/unnamed-chunk-44-1.png" width="576"></p>
</div>
</div>
<div id="things-to-keep-in-mind" class="section level2">
<h2 class="hasAnchor">
<a href="#things-to-keep-in-mind" class="anchor"></a>Things to Keep in Mind</h2>
<div id="operators" class="section level3">
<h3 class="hasAnchor">
<a href="#operators" class="anchor"></a>Operators</h3>
<p>These operators are supplied by the <code>mosmafs</code> package:</p>
<ul>
<li>
<strong><code><a href="../reference/mutGaussInt.html">mutGaussInt()</a></code>, <code><a href="../reference/mutPolynomialInt.html">mutPolynomialInt()</a></code>, <code><a href="../reference/mutUniformInt.html">mutUniformInt()</a></code>, <code><a href="../reference/recIntSBX.html">recIntSBX()</a></code></strong>: Mutation with rounding, for integer individuals. This is achieved through trivial application of <code><a href="../reference/intifyMutator.html">intifyMutator()</a></code>.</li>
<li>
<strong><code><a href="../reference/mutDoubleGeom.html">mutDoubleGeom()</a></code></strong>: Geometric distribution mutation, for integer individuals.</li>
<li>
<strong><code><a href="../reference/mutRandomChoice.html">mutRandomChoice()</a></code></strong>: Mutation for discrete individuals.</li>
<li>
<strong><code><a href="../reference/recPCrossover.html">recPCrossover()</a></code></strong>: Crossover recombination operator for individuals of any type.</li>
<li>
<strong><code><a href="../reference/mutBitflipCHW.html">mutBitflipCHW()</a></code></strong>: Bitflip that approximately conserves hamming weight (sum of digits) of binary individuals in expectation. This is useful for the <code>selector.selection</code> vector because it does not bias mutation away from the extremes (very few features selected, or very many features selected) as strongly.</li>
<li>
<strong><code><a href="../reference/mutUniformReset.html">mutUniformReset()</a></code></strong>: Extension of the <code><a href="https://rdrr.io/pkg/ecr/man/mutBitflip.html">mutBitflip()</a></code> operator that draws new values from a distribution <code>reset.dist</code>.</li>
<li>
<strong><code><a href="../reference/mutUniformMetaReset.html">mutUniformMetaReset()</a></code></strong>: Extension of the <code><a href="https://rdrr.io/pkg/ecr/man/mutBitflip.html">mutBitflip()</a></code> operator that draws new values from a set of distribution <code>reset.dists</code>, weighted by another parameter <code>reset.dist.weights</code>.</li>
<li>
<strong><code><a href="../reference/mutGaussScaled.html">mutGaussScaled()</a></code>, <code><a href="../reference/mutGaussIntScaled.html">mutGaussIntScaled()</a></code></strong>: Gaussian mutation with standard deviation scaled to the range of possible values.</li>
<li>
<strong><code><a href="../reference/selTournamentMO.html">selTournamentMO()</a></code></strong>: Multi-Objective k-tournament selection with individual rankging by nondominated sorting and secondarily either crowding distance or contribution to dominated hypervolume.</li>
<li>
<strong><code><a href="../reference/mutBitflipCHW.html">mutBitflipCHW()</a></code>, <code><a href="../reference/mutUniformResetSHW.html">mutUniformResetSHW()</a></code>, <code><a href="../reference/mutUniformResetSHW.html">mutUniformMetaResetSHW()</a></code></strong>: Binary operators that emulate <code><a href="https://rdrr.io/pkg/ecr/man/mutBitflip.html">mutBitflip()</a></code>, <code><a href="../reference/mutUniformReset.html">mutUniformReset()</a></code>, and <code><a href="../reference/mutUniformMetaReset.html">mutUniformMetaReset()</a></code> but keep the fraction of ones in the result more constant.</li>
</ul>
</div>
<div id="utility-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#utility-functions" class="anchor"></a>Utility Functions</h3>
<ul>
<li>
<strong><code><a href="../reference/popAggregate.html">popAggregate()</a></code>, <code><a href="../reference/availableAttributes.html">availableAttributes()</a></code></strong>: Information aggregated as matrix or dataframe for each generation in a population.</li>
<li>
<strong><code><a href="../reference/collectResult.html">collectResult()</a></code></strong>: Information aggregated throughout the run, on runtime and computation cost measures.</li>
<li>
<strong><code><a href="../reference/initSelector.html">initSelector()</a></code></strong> Resetting of individual’s <code>selector.selection</code> slot.</li>
</ul>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>In particular, they must have entries corresponding to the <strong>names</strong> of the possible values of a discrete parameter. Consider the <code>ParamSet</code> <code><a href="https://paramhelpers.mlr-org.com/reference/makeParamSet.html">makeParamSet(makeDiscreteParam("fn", values = list(a = identity, b = exp)))</a></code>. An individuum corresponding to this <code>ParamSet</code> would have to be one of <code><a href="https://rdrr.io/r/base/list.html">list(fn = "a")</a></code> or <code><a href="https://rdrr.io/r/base/list.html">list(fn = "b")</a></code>.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Martin Binder, Susanne Dandl, Julia Moosbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
